<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Get Verified on Our Platform</title>
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <script>
    (function(){
      emailjs.init("QI1aOpAqKdm9d4BkT");
    })();
  </script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial;
      background: #f6f8fa;
      padding: 20px;
    }
    form {
      background: white;
      padding: 20px;
      border-radius: 16px;
      max-width: 500px;
      margin: auto;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    input, textarea, select {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      margin-bottom: 20px;
      border: 1px solid #ddd;
      border-radius: 12px;
      font-size: 16px;
    }
    button {
      background: #007aff;
      color: white;
      border: none;
      padding: 15px 25px;
      border-radius: 14px;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    button:hover {
      background: #005ecb;
    }
  </style>
</head>
<body>

<h2 style="text-align:center;">âœ… Get Verified on Our Platform</h2>
<p style="text-align:center;">Submit your article or content URL to get a Verified Tick. Optional proof links help us verify faster.</p>

<form id="verifyForm">
  <input type="text" name="full_name" placeholder="Full Name" required>
  <input type="text" name="username" placeholder="Username / Handle" required>
  <input type="email" name="user_email" placeholder="Email ID" required>
  <input type="text" name="phone" placeholder="Mobile Number (+Country code)">
  <input type="url" name="article_url" placeholder="Article or Content URL" required>
  <textarea name="proof_links" placeholder="Optional Proof URLs (e.g., Twitter, LinkedIn)"></textarea>
  <input type="text" name="platform" placeholder="Platform Name (e.g., Blogger)">
  <textarea name="reason" placeholder="Why do you want verification?" maxlength="500" required></textarea>
  <select name="country" required>
    <option value="">Select Country</option>
    <option value="India">India</option>
    <option value="USA">USA</option>
    <option value="UK">UK</option>
    <!-- Add more countries as needed -->
  </select>
  <label><input type="checkbox" required> I agree to terms and allow content review.</label><br><br>
  <button type="submit">Submit Request</button>
</form>

<script>
  const form = document.getElementById("verifyForm");

  form.addEventListener("submit", async function(e) {
    e.preventDefault();

    const formData = new FormData(form);
    const articleURL = formData.get("article_url");

    // Fetch article title
    let title = "Your Article";
    try {
      const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(articleURL)}`);
      const data = await response.json();
      const doc = new DOMParser().parseFromString(data.contents, "text/html");
      title = doc.title || "Article Submitted";
    } catch (err) {
      console.error("Failed to fetch article title");
    }

    // Append article title to email template
    formData.append("article_title", title);

    // Send Email via EmailJS
    emailjs.sendForm("service_z3x1v6e", "template_yl4fwyg", form)
      .then(() => {
        alert(`Thanks! We've received your verification request. Track it at: /verified/${formData.get("username")}`);
        form.reset();
      }, (error) => {
        alert("Error submitting form. Try again later.");
        console.error("EmailJS Error:", error);
      });
  });
</script>

</body>
</html>
