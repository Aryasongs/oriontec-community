<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oriontec Charts™ - Professional Trading Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background: #000000;
            color: #ffffff;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            margin: 0;
            padding: 8px;
            min-height: 100vh;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px 0;
            border-bottom: 1px solid #2c2c2e;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .theme-toggle {
            padding: 8px 16px;
            background: #2c2c2e;
            border: none;
            border-radius: 8px;
            color: #ffffff;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .theme-toggle:hover {
            background: #3a3a3c;
        }

        .watchlist-ticker {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #1c1c1e;
            border-top: 1px solid #2c2c2e;
            height: 50px;
            overflow: hidden;
            z-index: 100;
        }

        .ticker-content {
            display: flex;
            align-items: center;
            height: 100%;
            animation: scroll 30s linear infinite;
            white-space: nowrap;
        }

        .ticker-item {
            display: inline-flex;
            align-items: center;
            padding: 0 30px;
            font-size: 14px;
            font-weight: 500;
        }

        .ticker-symbol {
            color: #ffffff;
            margin-right: 8px;
        }

        .ticker-price {
            margin-right: 8px;
        }

        .ticker-change {
            font-size: 12px;
        }

        @keyframes scroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .stock-selector {
            display: flex;
            gap: 15px;
        }

        .stock-tab {
            padding: 8px 16px;
            background: #2c2c2e;
            border: none;
            border-radius: 8px;
            color: #ffffff;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .stock-tab.active {
            background: #007aff;
        }

        .stock-tab:hover {
            background: #3a3a3c;
        }

        .stock-tab.active:hover {
            background: #0056cc;
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 350px;
            gap: 8px;
            margin-bottom: 60px;
            min-height: calc(100vh - 120px);
        }

        .indicators-panel {
            background: #1c1c1e;
            border-radius: 16px;
            padding: 20px;
            border: none;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .indicators-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #ffffff;
        }

        .indicator-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #2c2c2e;
        }

        .indicator-toggle:last-child {
            border-bottom: none;
        }

        .indicator-name {
            font-size: 14px;
            color: #ffffff;
        }

        .toggle-switch {
            position: relative;
            width: 40px;
            height: 20px;
            background: #3a3a3c;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active {
            background: #007aff;
        }

        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 16px;
            height: 16px;
            background: #ffffff;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(20px);
        }

        .comparison-section {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid #2c2c2e;
            flex-shrink: 0;
        }

        .benchmark-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            font-size: 12px;
        }

        .benchmark-name {
            color: #8e8e93;
        }

        .benchmark-change {
            font-weight: 500;
        }

        .chart-section {
            background: #1c1c1e;
            border-radius: 12px;
            padding: 16px;
            border: none;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 12px;
            min-height: 0;
        }

        .stock-info {
            margin-bottom: 20px;
        }

        .stock-symbol {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stock-price {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .price-change {
            font-size: 16px;
            font-weight: 500;
        }

        .price-up {
            color: #30d158;
        }

        .price-down {
            color: #ff453a;
        }

        .chart-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .timeframe-selector {
            display: flex;
            gap: 5px;
        }

        .timeframe-btn {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid #3a3a3c;
            border-radius: 6px;
            color: #ffffff;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .timeframe-btn.active {
            background: #007aff;
            border-color: #007aff;
        }

        .chart-options {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chart-type-btn {
            padding: 6px 12px;
            background: #2c2c2e;
            border: none;
            border-radius: 6px;
            color: #ffffff;
            cursor: pointer;
            font-size: 12px;
        }

        .chart-container {
            position: relative;
            height: 600px;
            background: #1c1c1e;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
            flex: 1;
        }

        .news-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ff9f0a;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            cursor: pointer;
            z-index: 10;
            border: 2px solid #1c1c1e;
        }

        .news-marker.earnings {
            background: #30d158;
        }

        .news-marker.product {
            background: #007aff;
        }

        .news-marker.deal {
            background: #bf5af2;
        }

        .news-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            display: none;
            border: 1px solid #3a3a3c;
            max-width: 250px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .news-tooltip h4 {
            margin-bottom: 5px;
            color: #007aff;
            font-size: 13px;
        }

        .analyst-section {
            background: #1c1c1e;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #2c2c2e;
        }

        .analyst-ratings {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .rating-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            text-align: center;
            flex: 1;
        }

        .rating-buy {
            background: rgba(48, 209, 88, 0.2);
            color: #30d158;
            border: 1px solid #30d158;
        }

        .rating-hold {
            background: rgba(255, 159, 10, 0.2);
            color: #ff9f0a;
            border: 1px solid #ff9f0a;
        }

        .rating-sell {
            background: rgba(255, 69, 58, 0.2);
            color: #ff453a;
            border: 1px solid #ff453a;
        }

        .support-resistance {
            margin-top: 15px;
        }

        .sr-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            font-size: 12px;
        }

        .sr-label {
            color: #8e8e93;
        }

        .sr-price {
            font-weight: 500;
        }

        .support {
            color: #30d158;
        }

        .resistance {
            color: #ff453a;
        }

        .chart-canvas {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .price-grid {
            position: absolute;
            top: 0;
            right: 0;
            width: 60px;
            height: 100%;
            background: rgba(28, 28, 30, 0.9);
            border-left: 1px solid #3a3a3c;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 10px 5px;
        }

        .price-label {
            font-size: 11px;
            color: #8e8e93;
            text-align: right;
        }

        .candlestick-chart {
            position: absolute;
            top: 0;
            left: 0;
            right: 60px;
            height: 100%;
            display: flex;
            align-items: flex-end;
            padding: 20px 10px;
        }

        .candle {
            flex: 1;
            margin: 0 1px;
            position: relative;
            cursor: crosshair;
        }

        .candle-body {
            width: 100%;
            border-radius: 1px;
            position: relative;
        }

        .candle-wick {
            width: 1px;
            background: #8e8e93;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .green-candle {
            background: #30d158;
        }

        .red-candle {
            background: #ff453a;
        }

        .blue-candle {
            background: #007aff;
        }

        .volume-chart {
            height: 80px;
            background: #1c1c1e;
            border-radius: 8px;
            margin-bottom: 20px;
            position: relative;
            border: 1px solid #2c2c2e;
        }

        .volume-bars {
            display: flex;
            align-items: flex-end;
            height: 100%;
            padding: 10px;
        }

        .volume-bar {
            flex: 1;
            margin: 0 1px;
            border-radius: 1px 1px 0 0;
            opacity: 0.7;
        }

        .rsi-chart {
            height: 100px;
            background: #1c1c1e;
            border-radius: 8px;
            border: 1px solid #2c2c2e;
            position: relative;
            padding: 15px;
            display: none;
        }

        .rsi-chart.active {
            display: block;
        }

        .rsi-title {
            font-size: 12px;
            color: #8e8e93;
            margin-bottom: 10px;
        }

        .rsi-line {
            height: 60px;
            position: relative;
            background: linear-gradient(to right, transparent 0%, #007aff 50%, transparent 100%);
            border-radius: 2px;
            opacity: 0.3;
        }

        .rsi-levels {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-size: 10px;
            color: #8e8e93;
        }

        .macd-chart {
            height: 100px;
            background: #1c1c1e;
            border-radius: 8px;
            border: 1px solid #2c2c2e;
            position: relative;
            padding: 15px;
            display: none;
            margin-bottom: 20px;
        }

        .macd-chart.active {
            display: block;
        }

        .bollinger-bands {
            position: absolute;
            top: 0;
            left: 0;
            right: 60px;
            height: 100%;
            pointer-events: none;
            display: none;
        }

        .bollinger-bands.active {
            display: block;
        }

        .bb-upper, .bb-lower, .bb-middle {
            position: absolute;
            width: 100%;
            height: 1px;
            opacity: 0.6;
        }

        .bb-upper {
            background: #ff453a;
            top: 15%;
        }

        .bb-middle {
            background: #ff9f0a;
            top: 50%;
        }

        .bb-lower {
            background: #30d158;
            top: 85%;
        }

        .vwap-line {
            position: absolute;
            top: 0;
            left: 0;
            right: 60px;
            height: 100%;
            pointer-events: none;
            display: none;
        }

        .vwap-line.active {
            display: block;
        }

        .vwap-line::after {
            content: '';
            position: absolute;
            top: 40%;
            left: 0;
            right: 0;
            height: 2px;
            background: #bf5af2;
            opacity: 0.8;
        }

        .fibonacci-levels {
            position: absolute;
            top: 0;
            left: 0;
            right: 60px;
            height: 100%;
            pointer-events: none;
            display: none;
        }

        .fibonacci-levels.active {
            display: block;
        }

        .fib-level {
            position: absolute;
            width: 100%;
            height: 1px;
            opacity: 0.5;
            border-top: 1px dashed;
        }

        .fib-0 { top: 0%; border-color: #ff453a; }
        .fib-236 { top: 23.6%; border-color: #ff9f0a; }
        .fib-382 { top: 38.2%; border-color: #ffcc02; }
        .fib-50 { top: 50%; border-color: #30d158; }
        .fib-618 { top: 61.8%; border-color: #007aff; }
        .fib-100 { top: 100%; border-color: #bf5af2; }

        .sidebar {
            background: #1c1c1e;
            border-radius: 12px;
            padding: 16px;
            border: none;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 12px;
            min-height: 0;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #ffffff;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .stat-label {
            color: #8e8e93;
        }

        .stat-value {
            color: #ffffff;
            font-weight: 500;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            display: none;
            border: 1px solid #3a3a3c;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            min-width: 200px;
        }

        .tooltip-header {
            font-weight: 600;
            margin-bottom: 8px;
            color: #007aff;
            border-bottom: 1px solid #3a3a3c;
            padding-bottom: 5px;
        }

        .tooltip-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .tooltip-label {
            color: #8e8e93;
        }

        .tooltip-value {
            color: #ffffff;
            font-weight: 500;
        }

        .branding {
            position: fixed;
            bottom: 60px;
            right: 20px;
            font-size: 10px;
            color: #8e8e93;
            z-index: 1000;
            cursor: pointer;
            user-select: none;
        }

        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            display: none;
            overflow-y: auto;
        }

        .admin-content {
            max-width: 1200px;
            margin: 50px auto;
            padding: 30px;
            background: #1c1c1e;
            border-radius: 16px;
            border: 1px solid #2c2c2e;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #2c2c2e;
        }

        .admin-title {
            font-size: 24px;
            font-weight: 700;
            color: #007aff;
        }

        .close-admin {
            background: #ff453a;
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        .admin-sections {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .admin-section {
            background: #2c2c2e;
            padding: 20px;
            border-radius: 12px;
        }

        .admin-section h3 {
            color: #ffffff;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .admin-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .admin-input, .admin-select, .admin-textarea {
            background: #1c1c1e;
            border: 1px solid #3a3a3c;
            color: #ffffff;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
        }

        .admin-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .admin-btn {
            background: #007aff;
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .admin-btn:hover {
            background: #0056cc;
        }

        .admin-btn.danger {
            background: #ff453a;
        }

        .admin-btn.danger:hover {
            background: #cc1f1a;
        }

        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 15000;
        }

        .login-box {
            background: #1c1c1e;
            padding: 40px;
            border-radius: 16px;
            border: 1px solid #2c2c2e;
            text-align: center;
            min-width: 300px;
        }

        .login-title {
            color: #007aff;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .login-input {
            width: 100%;
            background: #2c2c2e;
            border: 1px solid #3a3a3c;
            color: #ffffff;
            padding: 12px;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
        }

        .login-buttons {
            display: flex;
            gap: 10px;
        }

        .news-list {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .news-item {
            background: #1c1c1e;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            border: 1px solid #3a3a3c;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .news-content {
            flex: 1;
        }

        .news-title {
            color: #ffffff;
            font-size: 12px;
            font-weight: 500;
        }

        .news-date {
            color: #8e8e93;
            font-size: 10px;
        }

        .delete-news {
            background: #ff453a;
            border: none;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-connected {
            background: #30d158;
        }

        .status-disconnected {
            background: #ff453a;
        }

        .moving-average-line {
            position: absolute;
            top: 0;
            left: 0;
            right: 60px;
            height: 100%;
            pointer-events: none;
        }

        .ma-50 {
            border-top: 1px solid #ff9f0a;
            position: absolute;
            width: 100%;
            top: 30%;
        }

        .ma-200 {
            border-top: 1px solid #bf5af2;
            position: absolute;
            width: 100%;
            top: 60%;
        }

        .legend {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
            font-size: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-color {
            width: 12px;
            height: 2px;
            border-radius: 1px;
        }

        @media (max-width: 1400px) {
            .main-content {
                grid-template-columns: 260px 1fr 300px;
                gap: 6px;
            }
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 240px 1fr 280px;
                gap: 6px;
            }
            
            .container {
                padding: 6px;
            }
            
            .chart-container {
                height: 550px;
            }
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 8px;
                margin-bottom: 60px;
                min-height: auto;
            }
            
            .indicators-panel {
                order: -2;
                height: auto;
                min-height: 200px;
            }
            
            .sidebar {
                order: -1;
                height: auto;
                min-height: 300px;
            }
            
            .chart-section {
                height: auto;
                min-height: 500px;
            }
            
            .chart-container {
                height: 450px;
                flex: none;
                min-height: 400px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 4px;
            }
            
            .header {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
                margin-bottom: 6px;
                padding: 6px 0;
            }
            
            .stock-selector {
                width: 100%;
                justify-content: space-between;
                flex-wrap: wrap;
                gap: 4px;
            }
            
            .stock-tab {
                flex: 1;
                min-width: 110px;
                font-size: 11px;
                padding: 6px 8px;
            }
            
            .chart-controls {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }
            
            .timeframe-selector {
                width: 100%;
                justify-content: space-between;
            }
            
            .timeframe-btn {
                flex: 1;
                font-size: 10px;
                padding: 4px 6px;
            }
            
            .chart-container {
                height: 380px;
                min-height: 350px;
            }
            
            .indicators-panel, .sidebar, .chart-section {
                padding: 12px;
                border-radius: 10px;
            }
            
            .sidebar-section {
                margin-bottom: 15px;
            }
            
            .indicator-toggle {
                padding: 6px 0;
            }
            
            .indicator-name {
                font-size: 12px;
            }
            
            .main-content {
                gap: 6px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 2px;
            }
            
            .stock-tab {
                font-size: 10px;
                padding: 4px 6px;
                min-width: 100px;
            }
            
            .chart-container {
                height: 320px;
                min-height: 300px;
            }
            
            .indicators-panel, .sidebar, .chart-section {
                padding: 10px;
                border-radius: 8px;
            }
            
            .stock-symbol {
                font-size: 18px;
            }
            
            .stock-price {
                font-size: 24px;
            }
            
            .price-change {
                font-size: 12px;
            }
            
            .main-content {
                gap: 4px;
                margin-bottom: 55px;
            }
            
            .header {
                margin-bottom: 4px;
                padding: 4px 0;
            }
            
            .stock-selector {
                gap: 2px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="stock-selector">
                <button class="stock-tab active" data-stock="DZRA">Dozera Group ($DZRA)</button>
                <button class="stock-tab" data-stock="ORIN">Oriontec ($ORIN)</button>
                <button class="stock-tab" data-stock="VRZO">Vorzo ($VRZO)</button>
            </div>
            <div class="header-controls">
                <button class="theme-toggle" onclick="toggleTheme()">🌙 Dark</button>
            </div>
        </div>

        <div class="main-content">
            <div class="indicators-panel">
                <div class="indicators-title">Technical Indicators</div>
                <div class="indicator-toggle">
                    <span class="indicator-name">RSI (14)</span>
                    <div class="toggle-switch active" data-indicator="rsi">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                <div class="indicator-toggle">
                    <span class="indicator-name">MACD</span>
                    <div class="toggle-switch" data-indicator="macd">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                <div class="indicator-toggle">
                    <span class="indicator-name">Bollinger Bands</span>
                    <div class="toggle-switch" data-indicator="bollinger">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                <div class="indicator-toggle">
                    <span class="indicator-name">VWAP</span>
                    <div class="toggle-switch" data-indicator="vwap">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                <div class="indicator-toggle">
                    <span class="indicator-name">Fibonacci</span>
                    <div class="toggle-switch" data-indicator="fibonacci">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                
                <div class="comparison-section">
                    <div class="indicators-title">Market Comparison</div>
                    <div class="benchmark-item">
                        <span class="benchmark-name">S&P 500</span>
                        <span class="benchmark-change price-down" id="sp500Change">-0.6%</span>
                    </div>
                    <div class="benchmark-item">
                        <span class="benchmark-name">Nasdaq</span>
                        <span class="benchmark-change price-down" id="nasdaqChange">-0.8%</span>
                    </div>
                    <div class="benchmark-item">
                        <span class="benchmark-name">Nifty 50</span>
                        <span class="benchmark-change price-up" id="niftyChange">+0.3%</span>
                    </div>
                </div>
            </div>

            <div class="chart-section">
                <div class="stock-info">
                    <div class="stock-symbol" id="currentSymbol">Dozera Group (DZRA)</div>
                    <div class="stock-price price-down" id="currentPrice">$24.10</div>
                    <div class="price-change price-down" id="priceChange">-$0.90 (-3.60%) Today</div>
                </div>

                <div class="chart-controls">
                    <div class="timeframe-selector">
                        <button class="timeframe-btn active">1D</button>
                        <button class="timeframe-btn">5D</button>
                        <button class="timeframe-btn">1M</button>
                        <button class="timeframe-btn">6M</button>
                        <button class="timeframe-btn">1Y</button>
                    </div>
                    <div class="chart-options">
                        <button class="chart-type-btn">Candlestick</button>
                        <button class="chart-type-btn">Line</button>
                    </div>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ff9f0a;"></div>
                        <span>MA 50</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #bf5af2;"></div>
                        <span>MA 200</span>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="candlestick-chart" id="candlestickChart"></div>
                    <div class="moving-average-line">
                        <div class="ma-50"></div>
                        <div class="ma-200"></div>
                    </div>
                    <div class="bollinger-bands" id="bollingerBands">
                        <div class="bb-upper"></div>
                        <div class="bb-middle"></div>
                        <div class="bb-lower"></div>
                    </div>
                    <div class="vwap-line" id="vwapLine"></div>
                    <div class="fibonacci-levels" id="fibonacciLevels">
                        <div class="fib-level fib-0"></div>
                        <div class="fib-level fib-236"></div>
                        <div class="fib-level fib-382"></div>
                        <div class="fib-level fib-50"></div>
                        <div class="fib-level fib-618"></div>
                        <div class="fib-level fib-100"></div>
                    </div>
                    <div class="price-grid">
                        <div class="price-label">$45.00</div>
                        <div class="price-label">$40.00</div>
                        <div class="price-label">$35.00</div>
                        <div class="price-label">$30.00</div>
                        <div class="price-label">$25.00</div>
                        <div class="price-label">$20.00</div>
                        <div class="price-label">$15.00</div>
                    </div>
                </div>

                <div class="volume-chart">
                    <div class="volume-bars" id="volumeBars"></div>
                </div>

                <div class="rsi-chart" id="rsiChart">
                    <div class="rsi-title">RSI (14)</div>
                    <div class="rsi-line"></div>
                    <div class="rsi-levels">
                        <span>70</span>
                        <span>50</span>
                        <span>30</span>
                    </div>
                </div>

                <div class="macd-chart" id="macdChart">
                    <div class="rsi-title">MACD</div>
                    <div class="rsi-line" style="background: linear-gradient(to right, #ff453a 0%, #30d158 50%, #007aff 100%);"></div>
                    <div class="rsi-levels">
                        <span>Signal</span>
                        <span>MACD</span>
                        <span>Histogram</span>
                    </div>
                </div>

                <div class="analyst-section">
                    <div class="sidebar-title">Analyst Ratings</div>
                    <div class="analyst-ratings" id="analystRatings">
                        <div class="rating-badge rating-buy" id="buyRating">78% Buy</div>
                        <div class="rating-badge rating-hold" id="holdRating">18% Hold</div>
                        <div class="rating-badge rating-sell" id="sellRating">4% Sell</div>
                    </div>
                    <div class="support-resistance">
                        <div class="sr-line">
                            <span class="sr-label">🔻 Support</span>
                            <span class="sr-price support" id="supportLevel">$18.00</span>
                        </div>
                        <div class="sr-line">
                            <span class="sr-label">🔺 Resistance</span>
                            <span class="sr-price resistance" id="resistanceLevel">$27.00</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title">Market Data</div>
                    <div class="stat-row">
                        <span class="stat-label">Market Cap</span>
                        <span class="stat-value" id="marketCap">$2.84B</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">P/E Ratio</span>
                        <span class="stat-value" id="peRatio">18.45</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Volume</span>
                        <span class="stat-value" id="volume">8.2M</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Avg Volume</span>
                        <span class="stat-value" id="avgVolume">2.1M</span>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">52-Week Range</div>
                    <div class="stat-row">
                        <span class="stat-label">High</span>
                        <span class="stat-value" id="weekHigh">$40.00</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Low</span>
                        <span class="stat-value" id="weekLow">$12.50</span>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">Key Dates</div>
                    <div class="stat-row">
                        <span class="stat-label">Earnings Date</span>
                        <span class="stat-value" id="earningsDate">Feb 15, 2024</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Ex-Dividend</span>
                        <span class="stat-value" id="exDividend">Jan 28, 2024</span>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">Analyst Estimates</div>
                    <div class="stat-row">
                        <span class="stat-label">Price Target</span>
                        <span class="stat-value" id="priceTarget">$45.00</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Rating</span>
                        <span class="stat-value" id="rating">Strong Buy</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="tooltip" id="tooltip"></div>
        <div class="news-tooltip" id="newsTooltip"></div>
        
        <div class="watchlist-ticker">
            <div class="ticker-content">
                <div class="ticker-item">
                    <span class="ticker-symbol">$DZRA</span>
                    <span class="ticker-price">$24.10</span>
                    <span class="ticker-change price-down">▼3.6%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">$ORIN</span>
                    <span class="ticker-price">$19.50</span>
                    <span class="ticker-change price-down">▼1.3%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">$VRZO</span>
                    <span class="ticker-price">$22.00</span>
                    <span class="ticker-change price-down">▼6.4%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">S&P 500</span>
                    <span class="ticker-price">4,127.83</span>
                    <span class="ticker-change price-down">▼0.6%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">NASDAQ</span>
                    <span class="ticker-price">12,658.19</span>
                    <span class="ticker-change price-down">▼0.8%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">NIFTY 50</span>
                    <span class="ticker-price">19,674.25</span>
                    <span class="ticker-change price-up">▲0.3%</span>
                </div>
            </div>
        </div>
        
        <div class="branding" id="brandingText">Powered by Oriontec Charts™</div>
    </div>

    <!-- Admin Login Overlay -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-box">
            <div class="login-title">🔐 Admin Access</div>
            <input type="password" class="login-input" id="adminCode" placeholder="Enter Access Code" maxlength="10">
            <div class="login-buttons">
                <button class="admin-btn" onclick="verifyAdmin()">Login</button>
                <button class="admin-btn danger" onclick="closeAdminLogin()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-content">
            <div class="admin-header">
                <div class="admin-title">
                    <span class="status-indicator" id="firebaseStatus"></span>
                    📊 Oriontec Charts™ Admin Panel
                </div>
                <button class="close-admin" onclick="closeAdminPanel()">Close</button>
            </div>
            
            <div class="admin-sections">
                <!-- Stock Price Management -->
                <div class="admin-section">
                    <h3>📈 Stock Price Control</h3>
                    <div class="admin-form">
                        <select class="admin-select" id="stockSelect">
                            <option value="DZRA">Dozera Group (DZRA)</option>
                            <option value="ORIN">Oriontec (ORIN)</option>
                            <option value="VRZO">Vorzo (VRZO)</option>
                        </select>
                        <input type="number" class="admin-input" id="newPrice" placeholder="New Price ($)" step="0.01">
                        <input type="number" class="admin-input" id="priceChange" placeholder="Change Amount ($)" step="0.01">
                        <input type="number" class="admin-input" id="changePercent" placeholder="Change Percent (%)" step="0.01">
                        <button class="admin-btn" onclick="updateStockPrice()">Update Price</button>
                        <button class="admin-btn danger" onclick="simulateMarketCrash()">Simulate Market Drop</button>
                    </div>
                </div>

                <!-- News Management -->
                <div class="admin-section">
                    <h3>📰 News & Events</h3>
                    <div class="admin-form">
                        <select class="admin-select" id="newsStock">
                            <option value="DZRA">Dozera Group</option>
                            <option value="ORIN">Oriontec</option>
                            <option value="VRZO">Vorzo</option>
                        </select>
                        <select class="admin-select" id="newsType">
                            <option value="earnings">🔔 Earnings</option>
                            <option value="product">💻 Product Launch</option>
                            <option value="deal">💼 Business Deal</option>
                            <option value="factory">🏗️ Factory/Investment</option>
                        </select>
                        <input type="text" class="admin-input" id="newsTitle" placeholder="News Title">
                        <textarea class="admin-textarea" id="newsDescription" placeholder="News Description"></textarea>
                        <button class="admin-btn" onclick="addNewsEvent()">Add News Event</button>
                    </div>
                    
                    <div class="news-list" id="newsList">
                        <!-- News items will be populated here -->
                    </div>
                </div>

                <!-- Market Data Control -->
                <div class="admin-section">
                    <h3>📊 Market Data</h3>
                    <div class="admin-form">
                        <input type="text" class="admin-input" id="marketCapInput" placeholder="Market Cap (e.g., $2.84B)">
                        <input type="number" class="admin-input" id="peRatioInput" placeholder="P/E Ratio" step="0.01">
                        <input type="text" class="admin-input" id="volumeInput" placeholder="Volume (e.g., 8.2M)">
                        <input type="text" class="admin-input" id="avgVolumeInput" placeholder="Avg Volume (e.g., 2.1M)">
                        <button class="admin-btn" onclick="updateMarketData()">Update Market Data</button>
                    </div>
                </div>

                <!-- System Controls -->
                <div class="admin-section">
                    <h3>⚙️ System Controls</h3>
                    <div class="admin-form">
                        <button class="admin-btn" onclick="refreshAllData()">🔄 Refresh All Data</button>
                        <button class="admin-btn" onclick="exportData()">📤 Export Data</button>
                        <button class="admin-btn" onclick="resetToDefaults()">🔄 Reset to Defaults</button>
                        <button class="admin-btn danger" onclick="clearAllNews()">🗑️ Clear All News</button>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: #1c1c1e; border-radius: 8px;">
                        <div style="color: #8e8e93; font-size: 12px; margin-bottom: 5px;">Firebase Status:</div>
                        <div id="connectionStatus" style="color: #30d158; font-size: 12px;">🟢 Connected</div>
                        <div style="color: #8e8e93; font-size: 10px; margin-top: 5px;">Last Update: <span id="lastUpdate">Just now</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCCWB4adPUSrSW2cSd9I3oqYIw65ZnStj4",
            authDomain: "twitter-1903a.firebaseapp.com",
            databaseURL: "https://twitter-1903a-default-rtdb.firebaseio.com",
            projectId: "twitter-1903a",
            storageBucket: "twitter-1903a.firebasestorage.app",
            messagingSenderId: "37758914989",
            appId: "1:37758914989:web:6c364d74288a8b08f8d124"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // Admin access code and click tracking
        const ADMIN_CODE = "7973804008";
        let isAdminLoggedIn = false;
        let brandingClickCount = 0;
        let brandingClickTimer = null;
        
        // Firebase connection status
        let firebaseConnected = false;
        
        // Technical indicators state
        const indicatorStates = {
            rsi: true,
            macd: false,
            bollinger: false,
            vwap: false,
            fibonacci: false
        };
        
        // Initialize Firebase connection monitoring
        const connectedRef = database.ref(".info/connected");
        connectedRef.on("value", (snap) => {
            firebaseConnected = snap.val() === true;
            updateFirebaseStatus();
        });
        
        function updateFirebaseStatus() {
            const statusIndicator = document.getElementById('firebaseStatus');
            const connectionStatus = document.getElementById('connectionStatus');
            
            if (firebaseConnected) {
                if (statusIndicator) statusIndicator.className = 'status-indicator status-connected';
                if (connectionStatus) connectionStatus.innerHTML = '🟢 Connected';
            } else {
                if (statusIndicator) statusIndicator.className = 'status-indicator status-disconnected';
                if (connectionStatus) connectionStatus.innerHTML = '🔴 Disconnected';
            }
            
            const lastUpdate = document.getElementById('lastUpdate');
            if (lastUpdate) lastUpdate.textContent = new Date().toLocaleTimeString();
        }
        
        // 5-Click Admin Access
        function handleBrandingClick() {
            brandingClickCount++;
            
            if (brandingClickTimer) {
                clearTimeout(brandingClickTimer);
            }
            
            if (brandingClickCount >= 5) {
                showAdminLogin();
                brandingClickCount = 0;
                return;
            }
            
            // Reset counter after 3 seconds
            brandingClickTimer = setTimeout(() => {
                brandingClickCount = 0;
            }, 3000);
        }
        
        // Admin Panel Functions
        function showAdminLogin() {
            document.getElementById('loginOverlay').style.display = 'flex';
            document.getElementById('adminCode').focus();
        }
        
        function closeAdminLogin() {
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('adminCode').value = '';
        }
        
        function verifyAdmin() {
            const code = document.getElementById('adminCode').value;
            if (code === ADMIN_CODE) {
                isAdminLoggedIn = true;
                closeAdminLogin();
                showAdminPanel();
                loadAdminData();
            } else {
                alert('❌ Invalid access code!');
                document.getElementById('adminCode').value = '';
            }
        }
        
        function showAdminPanel() {
            document.getElementById('adminPanel').style.display = 'block';
            updateFirebaseStatus();
        }
        
        function closeAdminPanel() {
            document.getElementById('adminPanel').style.display = 'none';
            isAdminLoggedIn = false;
        }
        
        function loadAdminData() {
            // Load current stock data into admin forms
            const currentStockData = stockData[currentStock];
            document.getElementById('newPrice').value = currentStockData.currentPrice;
            document.getElementById('priceChange').value = currentStockData.change;
            document.getElementById('changePercent').value = currentStockData.changePercent;
            
            // Load news events
            loadNewsEvents();
        }
        
        function updateStockPrice() {
            if (!isAdminLoggedIn) return;
            
            const selectedStock = document.getElementById('stockSelect').value;
            const newPrice = parseFloat(document.getElementById('newPrice').value);
            const priceChange = parseFloat(document.getElementById('priceChange').value);
            const changePercent = parseFloat(document.getElementById('changePercent').value);
            
            if (isNaN(newPrice)) {
                alert('Please enter a valid price');
                return;
            }
            
            // Update local data
            stockData[selectedStock].currentPrice = newPrice;
            if (!isNaN(priceChange)) stockData[selectedStock].change = priceChange;
            if (!isNaN(changePercent)) stockData[selectedStock].changePercent = changePercent;
            
            // Update Firebase
            const updates = {
                [`stocks/${selectedStock}/currentPrice`]: newPrice,
                [`stocks/${selectedStock}/change`]: priceChange || stockData[selectedStock].change,
                [`stocks/${selectedStock}/changePercent`]: changePercent || stockData[selectedStock].changePercent,
                [`stocks/${selectedStock}/lastUpdate`]: Date.now()
            };
            
            database.ref().update(updates).then(() => {
                console.log('✅ Stock price updated successfully');
                if (selectedStock === currentStock) {
                    updateStockDisplay(currentStock);
                }
                updateTickerPrices();
            }).catch((error) => {
                console.error('❌ Error updating stock price:', error);
            });
        }
        
        function simulateMarketCrash() {
            if (!isAdminLoggedIn) return;
            
            if (!confirm('⚠️ This will simulate a market crash for all stocks. Continue?')) return;
            
            const crashUpdates = {};
            Object.keys(stockData).forEach(symbol => {
                const currentPrice = stockData[symbol].currentPrice;
                const crashPrice = currentPrice * (0.85 + Math.random() * 0.1); // 10-15% drop
                const change = crashPrice - currentPrice;
                const changePercent = (change / currentPrice) * 100;
                
                stockData[symbol].currentPrice = crashPrice;
                stockData[symbol].change = change;
                stockData[symbol].changePercent = changePercent;
                
                crashUpdates[`stocks/${symbol}/currentPrice`] = crashPrice;
                crashUpdates[`stocks/${symbol}/change`] = change;
                crashUpdates[`stocks/${symbol}/changePercent`] = changePercent;
                crashUpdates[`stocks/${symbol}/lastUpdate`] = Date.now();
            });
            
            database.ref().update(crashUpdates).then(() => {
                console.log('📉 Market crash simulated');
                updateStockDisplay(currentStock);
                updateTickerPrices();
            });
        }
        
        function addNewsEvent() {
            if (!isAdminLoggedIn) return;
            
            const stock = document.getElementById('newsStock').value;
            const type = document.getElementById('newsType').value;
            const title = document.getElementById('newsTitle').value;
            const description = document.getElementById('newsDescription').value;
            
            if (!title || !description) {
                alert('Please fill in all news fields');
                return;
            }
            
            const newsEvent = {
                stock: stock,
                type: type,
                title: title,
                description: description,
                timestamp: Date.now(),
                id: Date.now().toString()
            };
            
            database.ref(`news/${newsEvent.id}`).set(newsEvent).then(() => {
                console.log('📰 News event added');
                document.getElementById('newsTitle').value = '';
                document.getElementById('newsDescription').value = '';
                loadNewsEvents();
            });
        }
        
        function loadNewsEvents() {
            database.ref('news').once('value', (snapshot) => {
                const newsData = snapshot.val() || {};
                const newsList = document.getElementById('newsList');
                newsList.innerHTML = '';
                
                Object.values(newsData).sort((a, b) => b.timestamp - a.timestamp).forEach(news => {
                    const newsItem = document.createElement('div');
                    newsItem.className = 'news-item';
                    newsItem.innerHTML = `
                        <div class="news-content">
                            <div class="news-title">${news.title}</div>
                            <div class="news-date">${new Date(news.timestamp).toLocaleDateString()}</div>
                        </div>
                        <button class="delete-news" onclick="deleteNews('${news.id}')">Delete</button>
                    `;
                    newsList.appendChild(newsItem);
                });
            });
        }
        
        function deleteNews(newsId) {
            if (!isAdminLoggedIn) return;
            
            database.ref(`news/${newsId}`).remove().then(() => {
                console.log('🗑️ News deleted');
                loadNewsEvents();
            });
        }
        
        function updateMarketData() {
            if (!isAdminLoggedIn) return;
            
            const selectedStock = document.getElementById('stockSelect').value;
            const marketCap = document.getElementById('marketCapInput').value;
            const peRatio = document.getElementById('peRatioInput').value;
            const volume = document.getElementById('volumeInput').value;
            const avgVolume = document.getElementById('avgVolumeInput').value;
            
            const updates = {};
            if (marketCap) {
                stockData[selectedStock].marketCap = marketCap;
                updates[`stocks/${selectedStock}/marketCap`] = marketCap;
            }
            if (peRatio) {
                stockData[selectedStock].peRatio = peRatio;
                updates[`stocks/${selectedStock}/peRatio`] = peRatio;
            }
            if (volume) {
                stockData[selectedStock].volume = volume;
                updates[`stocks/${selectedStock}/volume`] = volume;
            }
            if (avgVolume) {
                stockData[selectedStock].avgVolume = avgVolume;
                updates[`stocks/${selectedStock}/avgVolume`] = avgVolume;
            }
            
            if (Object.keys(updates).length > 0) {
                database.ref().update(updates).then(() => {
                    console.log('📊 Market data updated');
                    if (selectedStock === currentStock) {
                        updateStockDisplay(currentStock);
                    }
                });
            }
        }
        
        function refreshAllData() {
            if (!isAdminLoggedIn) return;
            
            database.ref('stocks').once('value', (snapshot) => {
                const firebaseData = snapshot.val() || {};
                Object.keys(firebaseData).forEach(symbol => {
                    if (stockData[symbol]) {
                        Object.assign(stockData[symbol], firebaseData[symbol]);
                    }
                });
                updateStockDisplay(currentStock);
                updateTickerPrices();
                console.log('🔄 All data refreshed from Firebase');
            });
        }
        
        function exportData() {
            if (!isAdminLoggedIn) return;
            
            const dataToExport = {
                stocks: stockData,
                timestamp: Date.now(),
                exportedBy: 'Admin'
            };
            
            const dataStr = JSON.stringify(dataToExport, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `oriontec-charts-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }
        
        function resetToDefaults() {
            if (!isAdminLoggedIn) return;
            
            if (!confirm('⚠️ This will reset all stock data to default values. Continue?')) return;
            
            // Reset to original values
            stockData.DZRA.currentPrice = 24.10;
            stockData.DZRA.change = -0.90;
            stockData.DZRA.changePercent = -3.60;
            
            stockData.ORIN.currentPrice = 19.50;
            stockData.ORIN.change = -0.25;
            stockData.ORIN.changePercent = -1.27;
            
            stockData.VRZO.currentPrice = 22.00;
            stockData.VRZO.change = -1.50;
            stockData.VRZO.changePercent = -6.38;
            
            // Update Firebase
            const resetUpdates = {};
            Object.keys(stockData).forEach(symbol => {
                resetUpdates[`stocks/${symbol}`] = {
                    currentPrice: stockData[symbol].currentPrice,
                    change: stockData[symbol].change,
                    changePercent: stockData[symbol].changePercent,
                    lastUpdate: Date.now()
                };
            });
            
            database.ref().update(resetUpdates).then(() => {
                console.log('🔄 Data reset to defaults');
                updateStockDisplay(currentStock);
                updateTickerPrices();
            });
        }
        
        function clearAllNews() {
            if (!isAdminLoggedIn) return;
            
            if (!confirm('⚠️ This will delete all news events. Continue?')) return;
            
            database.ref('news').remove().then(() => {
                console.log('🗑️ All news cleared');
                loadNewsEvents();
            });
        }
        
        function updateTickerPrices() {
            // Update ticker with current prices
            const tickerItems = document.querySelectorAll('.ticker-item');
            tickerItems.forEach(item => {
                const symbol = item.querySelector('.ticker-symbol').textContent;
                if (symbol === '$DZRA') {
                    const stock = stockData.DZRA;
                    item.querySelector('.ticker-price').textContent = `$${stock.currentPrice.toFixed(2)}`;
                    const changeEl = item.querySelector('.ticker-change');
                    changeEl.textContent = `${stock.changePercent >= 0 ? '▲' : '▼'}${Math.abs(stock.changePercent).toFixed(1)}%`;
                    changeEl.className = `ticker-change ${stock.changePercent >= 0 ? 'price-up' : 'price-down'}`;
                } else if (symbol === '$ORIN') {
                    const stock = stockData.ORIN;
                    item.querySelector('.ticker-price').textContent = `$${stock.currentPrice.toFixed(2)}`;
                    const changeEl = item.querySelector('.ticker-change');
                    changeEl.textContent = `${stock.changePercent >= 0 ? '▲' : '▼'}${Math.abs(stock.changePercent).toFixed(1)}%`;
                    changeEl.className = `ticker-change ${stock.changePercent >= 0 ? 'price-up' : 'price-down'}`;
                } else if (symbol === '$VRZO') {
                    const stock = stockData.VRZO;
                    item.querySelector('.ticker-price').textContent = `$${stock.currentPrice.toFixed(2)}`;
                    const changeEl = item.querySelector('.ticker-change');
                    changeEl.textContent = `${stock.changePercent >= 0 ? '▲' : '▼'}${Math.abs(stock.changePercent).toFixed(1)}%`;
                    changeEl.className = `ticker-change ${stock.changePercent >= 0 ? 'price-up' : 'price-down'}`;
                }
            });
        }
        
        // Listen for real-time updates
        database.ref('stocks').on('value', (snapshot) => {
            const firebaseData = snapshot.val() || {};
            let hasUpdates = false;
            
            Object.keys(firebaseData).forEach(symbol => {
                if (stockData[symbol]) {
                    const oldPrice = stockData[symbol].currentPrice;
                    Object.assign(stockData[symbol], firebaseData[symbol]);
                    if (oldPrice !== stockData[symbol].currentPrice) {
                        hasUpdates = true;
                    }
                }
            });
            
            if (hasUpdates) {
                updateStockDisplay(currentStock);
                updateTickerPrices();
                updateFirebaseStatus();
            }
        });
        
        // Keyboard shortcut for admin access (Ctrl+Shift+A)
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                e.preventDefault();
                showAdminLogin();
            }
        });
        
        // Allow Enter key in admin login
        document.getElementById('adminCode').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                verifyAdmin();
            }
        });

        // Stock data with dynamic analyst ratings
        const stockData = {
            DZRA: {
                name: "Dozera Group (DZRA)",
                currentPrice: 24.10,
                change: -0.90,
                changePercent: -3.60,
                marketCap: "$1.71B",
                peRatio: "18.45",
                volume: "2.1M",
                avgVolume: "2.1M",
                weekHigh: "$25.00",
                weekLow: "$12.50",
                earningsDate: "Feb 15, 2024",
                exDividend: "Jan 28, 2024",
                priceTarget: "$28.00",
                rating: "Hold",
                analystRatings: { buy: 65, hold: 28, sell: 7 },
                supportLevel: 18.00,
                resistanceLevel: 27.00,
                candleData: {},
                timeframes: {
                    '1D': generateCandleData(24.10, 'current', 24),
                    '5D': generateCandleData(24.10, 'current', 120),
                    '1M': generateCandleData(40.00, 'surge', 30),
                    '6M': generateCandleData(24.10, 'recovery', 180),
                    '1Y': generateCandleData(24.10, 'yearly', 365)
                }
            },
            ORIN: {
                name: "Oriontec (ORIN)",
                currentPrice: 19.50,
                change: -0.25,
                changePercent: -1.27,
                marketCap: "$1.30B",
                peRatio: "22.10",
                volume: "1.2M",
                avgVolume: "1.5M",
                weekHigh: "$24.50",
                weekLow: "$11.20",
                earningsDate: "Feb 22, 2024",
                exDividend: "Feb 05, 2024",
                priceTarget: "$23.00",
                rating: "Buy",
                analystRatings: { buy: 78, hold: 18, sell: 4 },
                supportLevel: 16.50,
                resistanceLevel: 23.00,
                candleData: {},
                timeframes: {
                    '1D': generateCandleData(19.50, 'current', 24),
                    '5D': generateCandleData(19.50, 'current', 120),
                    '1M': generateCandleData(22.75, 'gradual', 30),
                    '6M': generateCandleData(19.50, 'slow_recovery', 180),
                    '1Y': generateCandleData(19.50, 'yearly', 365)
                }
            },
            VRZO: {
                name: "Vorzo (VRZO)",
                currentPrice: 22.00,
                change: -1.50,
                changePercent: -6.38,
                marketCap: "$1.78B",
                peRatio: "N/A",
                volume: "3.5M",
                avgVolume: "2.8M",
                weekHigh: "$38.50",
                weekLow: "$15.80",
                earningsDate: "Mar 01, 2024",
                exDividend: "N/A",
                priceTarget: "$26.00",
                rating: "Hold",
                analystRatings: { buy: 45, hold: 40, sell: 15 },
                supportLevel: 19.00,
                resistanceLevel: 28.50,
                candleData: {},
                timeframes: {
                    '1D': generateCandleData(22.00, 'current', 24),
                    '5D': generateCandleData(22.00, 'current', 120),
                    '1M': generateCandleData(38.50, 'surge', 30),
                    '6M': generateCandleData(22.00, 'recovery', 180),
                    '1Y': generateCandleData(22.00, 'yearly', 365)
                }
            }
        };

        let currentStock = 'DZRA';
        let currentTimeframe = '1D';

        // Global synchronized price system
        let globalPriceState = {
            lastUpdate: Date.now(),
            dailyTrend: 'neutral', // 'up', 'down', 'neutral'
            weeklyPattern: 'normal', // 'crash', 'surge', 'normal'
            marketSession: 'open' // 'open', 'closed'
        };

        function simulateGlobalPriceSync() {
            const now = Date.now();
            const timeSinceUpdate = now - globalPriceState.lastUpdate;
            
            // Determine market session (9 AM to 4 PM EST simulation)
            const hour = new Date().getHours();
            globalPriceState.marketSession = (hour >= 9 && hour <= 16) ? 'open' : 'closed';
            
            // Weekly pattern changes (every 7 days simulation = 2 minutes)
            if (Math.random() < 0.001) { // Very rare crash
                globalPriceState.weeklyPattern = 'crash';
                console.log('📉 Market crash triggered globally!');
            } else if (Math.random() < 0.002) { // Rare surge
                globalPriceState.weeklyPattern = 'surge';
                console.log('📈 Market surge triggered globally!');
            } else if (Math.random() < 0.01) { // Return to normal
                globalPriceState.weeklyPattern = 'normal';
            }
            
            // Daily trend changes
            if (Math.random() < 0.05) {
                const trends = ['up', 'down', 'neutral'];
                globalPriceState.dailyTrend = trends[Math.floor(Math.random() * trends.length)];
            }
            
            // Apply synchronized changes to all stocks
            Object.keys(stockData).forEach(symbol => {
                updateStockPrice(symbol, globalPriceState);
            });
            
            globalPriceState.lastUpdate = now;
            updateStockDisplay(currentStock);
            updateTickerPrices();
            updateMarketIndices();
            
            // Save state to localStorage for persistence
            localStorage.setItem('globalPriceState', JSON.stringify(globalPriceState));
            localStorage.setItem('stockData', JSON.stringify(stockData));
        }

        function updateStockPrice(symbol, globalState) {
            const stock = stockData[symbol];
            let volatilityMultiplier = 1;
            let trendBias = 0;
            
            // Apply weekly pattern
            switch (globalState.weeklyPattern) {
                case 'crash':
                    volatilityMultiplier = 2.5;
                    trendBias = -0.08; // Strong downward bias
                    break;
                case 'surge':
                    volatilityMultiplier = 2.0;
                    trendBias = 0.06; // Strong upward bias
                    break;
                default:
                    volatilityMultiplier = 1;
                    trendBias = 0;
            }
            
            // Apply daily trend
            switch (globalState.dailyTrend) {
                case 'up':
                    trendBias += 0.02;
                    break;
                case 'down':
                    trendBias -= 0.02;
                    break;
            }
            
            // Market session affects volatility
            if (globalState.marketSession === 'closed') {
                volatilityMultiplier *= 0.3; // Much less movement after hours
            }
            
            // Calculate price change
            const baseVolatility = (Math.random() - 0.5) * 0.04; // -2% to +2%
            const finalChange = (baseVolatility + trendBias) * volatilityMultiplier;
            
            const newPrice = stock.currentPrice * (1 + finalChange);
            const change = newPrice - stock.currentPrice;
            const changePercent = (change / stock.currentPrice) * 100;
            
            stock.currentPrice = Math.max(0.01, newPrice);
            stock.change = change;
            stock.changePercent = changePercent;
            
            // Update analyst ratings based on performance
            updateAnalystRatings(symbol, changePercent);
        }
        
        function updateAnalystRatings(symbol, changePercent) {
            const stock = stockData[symbol];
            
            if (changePercent > 5) {
                // Strong positive performance - more buy ratings
                stock.analystRatings.buy = Math.min(90, stock.analystRatings.buy + 5);
                stock.analystRatings.sell = Math.max(2, stock.analystRatings.sell - 3);
                stock.analystRatings.hold = 100 - stock.analystRatings.buy - stock.analystRatings.sell;
            } else if (changePercent < -5) {
                // Poor performance - more sell/hold ratings
                stock.analystRatings.sell = Math.min(25, stock.analystRatings.sell + 4);
                stock.analystRatings.buy = Math.max(30, stock.analystRatings.buy - 5);
                stock.analystRatings.hold = 100 - stock.analystRatings.buy - stock.analystRatings.sell;
            } else {
                // Gradual adjustment towards neutral
                const targetBuy = 60 + Math.random() * 20;
                const targetSell = 5 + Math.random() * 10;
                const targetHold = 100 - targetBuy - targetSell;
                
                stock.analystRatings.buy += (targetBuy - stock.analystRatings.buy) * 0.1;
                stock.analystRatings.sell += (targetSell - stock.analystRatings.sell) * 0.1;
                stock.analystRatings.hold = 100 - stock.analystRatings.buy - stock.analystRatings.sell;
            }
            
            // Round to integers
            stock.analystRatings.buy = Math.round(stock.analystRatings.buy);
            stock.analystRatings.sell = Math.round(stock.analystRatings.sell);
            stock.analystRatings.hold = 100 - stock.analystRatings.buy - stock.analystRatings.sell;
        }
        
        function updateMarketIndices() {
            // Update market comparison indices
            const sp500Change = (Math.random() - 0.5) * 2; // -1% to +1%
            const nasdaqChange = (Math.random() - 0.5) * 2.5; // -1.25% to +1.25%
            const niftyChange = (Math.random() - 0.5) * 1.5; // -0.75% to +0.75%
            
            document.getElementById('sp500Change').textContent = `${sp500Change >= 0 ? '+' : ''}${sp500Change.toFixed(1)}%`;
            document.getElementById('sp500Change').className = `benchmark-change ${sp500Change >= 0 ? 'price-up' : 'price-down'}`;
            
            document.getElementById('nasdaqChange').textContent = `${nasdaqChange >= 0 ? '+' : ''}${nasdaqChange.toFixed(1)}%`;
            document.getElementById('nasdaqChange').className = `benchmark-change ${nasdaqChange >= 0 ? 'price-up' : 'price-down'}`;
            
            document.getElementById('niftyChange').textContent = `${niftyChange >= 0 ? '+' : ''}${niftyChange.toFixed(1)}%`;
            document.getElementById('niftyChange').className = `benchmark-change ${niftyChange >= 0 ? 'price-up' : 'price-down'}`;
        }
        
        // Load persistent data on page load
        function loadPersistentData() {
            const savedGlobalState = localStorage.getItem('globalPriceState');
            const savedStockData = localStorage.getItem('stockData');
            
            if (savedGlobalState) {
                globalPriceState = JSON.parse(savedGlobalState);
                console.log('📊 Loaded persistent global state');
            }
            
            if (savedStockData) {
                const saved = JSON.parse(savedStockData);
                Object.keys(saved).forEach(symbol => {
                    if (stockData[symbol]) {
                        stockData[symbol].currentPrice = saved[symbol].currentPrice;
                        stockData[symbol].change = saved[symbol].change;
                        stockData[symbol].changePercent = saved[symbol].changePercent;
                        stockData[symbol].analystRatings = saved[symbol].analystRatings || stockData[symbol].analystRatings;
                    }
                });
                console.log('💾 Loaded persistent stock prices');
            }
        }

        // Start global synchronized price updates (every 15 seconds)
        setInterval(simulateGlobalPriceSync, 15000);

        function generateCandleData(finalPrice, pattern, periods) {
            const candles = [];
            let basePrice = finalPrice;
            
            for (let i = 0; i < periods; i++) {
                let price;
                let volume;
                let candleType;
                
                if (pattern === 'current') {
                    // Current day/5day - mostly flat with small movements
                    price = basePrice + (Math.random() - 0.5) * 0.5;
                    volume = Math.random() * 0.3 + 0.2;
                    candleType = Math.random() > 0.6 ? 'red' : 'green';
                } else if (pattern === 'surge' && i > periods * 0.7) {
                    // Surge pattern for 1M view
                    const surgeStart = periods * 0.7;
                    const surgeProgress = (i - surgeStart) / (periods - surgeStart);
                    price = basePrice * 0.6 + (finalPrice - basePrice * 0.6) * Math.pow(surgeProgress, 0.5);
                    volume = Math.random() * 0.8 + 0.6;
                    candleType = surgeProgress > 0.3 ? 'blue' : 'green';
                } else if (pattern === 'gradual' && i > periods * 0.5) {
                    // Gradual rise for ORIN 1M
                    const gradualStart = periods * 0.5;
                    const gradualProgress = (i - gradualStart) / (periods - gradualStart);
                    price = basePrice * 0.85 + (finalPrice - basePrice * 0.85) * gradualProgress;
                    volume = Math.random() * 0.4 + 0.2;
                    candleType = 'green';
                } else if (pattern === 'recovery') {
                    // 6M recovery pattern
                    if (i < periods * 0.3) {
                        price = basePrice * (1.1 - i * 0.002); // Initial decline
                        candleType = 'red';
                    } else if (i < periods * 0.8) {
                        price = basePrice * 0.7 + Math.random() * basePrice * 0.1; // Consolidation
                        candleType = Math.random() > 0.5 ? 'green' : 'red';
                    } else {
                        const recoveryProgress = (i - periods * 0.8) / (periods * 0.2);
                        price = basePrice * 0.75 + (basePrice * 0.25) * recoveryProgress;
                        candleType = 'green';
                    }
                    volume = Math.random() * 0.5 + 0.3;
                } else if (pattern === 'yearly') {
                    // 1Y pattern with major volatility
                    if (i < periods * 0.2) {
                        price = basePrice * (1.3 - i * 0.001); // Early high
                        candleType = i < periods * 0.1 ? 'green' : 'red';
                    } else if (i < periods * 0.7) {
                        price = basePrice * (0.5 + Math.sin(i * 0.1) * 0.1); // Volatile middle
                        candleType = Math.random() > 0.5 ? 'green' : 'red';
                    } else {
                        const lateProgress = (i - periods * 0.7) / (periods * 0.3);
                        price = basePrice * 0.6 + (basePrice * 0.4) * lateProgress;
                        candleType = 'green';
                    }
                    volume = Math.random() * 0.6 + 0.4;
                } else {
                    // Default flat/declining
                    price = basePrice * (1 - i * 0.001) + (Math.random() - 0.5) * basePrice * 0.02;
                    volume = Math.random() * 0.4 + 0.2;
                    candleType = Math.random() > 0.4 ? 'red' : 'green';
                }
                
                const open = price + (Math.random() - 0.5) * price * 0.02;
                const close = price + (Math.random() - 0.5) * price * 0.02;
                const high = Math.max(open, close) + Math.random() * price * 0.015;
                const low = Math.min(open, close) - Math.random() * price * 0.015;
                
                candles.push({
                    open: Math.max(0, open),
                    high: Math.max(0, high),
                    low: Math.max(0, low),
                    close: Math.max(0, close),
                    volume: volume,
                    type: candleType
                });
            }
            
            return candles;
        }

        function renderCandlesticks(data) {
            const chart = document.getElementById('candlestickChart');
            chart.innerHTML = '';
            
            const maxPrice = Math.max(...data.map(d => d.high));
            const minPrice = Math.min(...data.map(d => d.low));
            const priceRange = maxPrice - minPrice;
            
            data.forEach((candle, index) => {
                const candleElement = document.createElement('div');
                candleElement.className = 'candle';
                
                const bodyHeight = Math.abs(candle.close - candle.open) / priceRange * 300;
                const bodyBottom = (candle.close < candle.open ? candle.close : candle.open - minPrice) / priceRange * 300;
                const wickTop = (maxPrice - candle.high) / priceRange * 300;
                const wickBottom = (candle.low - minPrice) / priceRange * 300;
                
                candleElement.innerHTML = `
                    <div class="candle-wick" style="top: ${wickTop}px; height: ${300 - wickTop - (300 - wickBottom)}px;"></div>
                    <div class="candle-body ${candle.type}-candle" style="height: ${Math.max(1, bodyHeight)}px; bottom: ${bodyBottom}px;"></div>
                `;
                
                candleElement.addEventListener('mouseenter', (e) => {
                    showTooltip(e, candle, index);
                });
                
                candleElement.addEventListener('mouseleave', hideTooltip);
                
                chart.appendChild(candleElement);
            });
            
            // Add news markers
            addNewsMarkers(data);
        }

        function addNewsMarkers(data) {
            const chart = document.getElementById('candlestickChart');
            const newsEvents = getNewsEvents(currentStock, currentTimeframe);
            
            newsEvents.forEach(event => {
                if (event.index < data.length) {
                    const marker = document.createElement('div');
                    marker.className = `news-marker ${event.type}`;
                    marker.innerHTML = event.icon;
                    marker.style.left = `${(event.index / data.length) * 100}%`;
                    marker.style.top = `${event.position}%`;
                    
                    marker.addEventListener('mouseenter', (e) => {
                        showNewsTooltip(e, event);
                    });
                    
                    marker.addEventListener('mouseleave', hideNewsTooltip);
                    
                    chart.appendChild(marker);
                }
            });
        }

        // Dynamic news generation system
        let globalNewsEvents = [];

        function generateRandomNews() {
            const newsTemplates = {
                DZRA: [
                    { type: 'earnings', icon: '🔔', title: 'Q{quarter} Earnings Report', description: 'Dozera Group reports {result} earnings - Revenue: ${revenue}M vs ${expected}M expected' },
                    { type: 'product', icon: '🏗️', title: 'Infrastructure Investment', description: 'New ${amount}M investment in {location} manufacturing facility announced' },
                    { type: 'deal', icon: '💼', title: 'Government Contract', description: 'Secured ${value}M infrastructure contract with {country} government' },
                    { type: 'factory', icon: '🏭', title: 'Production Update', description: 'Factory production increased by {percent}% this quarter' }
                ],
                ORIN: [
                    { type: 'product', icon: '💻', title: 'AI Platform Launch', description: 'Oriontec launches new {tech} analytics platform for {industry} sector' },
                    { type: 'deal', icon: '🤝', title: 'Strategic Partnership', description: 'Partnership with {company} to develop {technology} solutions' },
                    { type: 'earnings', icon: '🔔', title: 'Tech Earnings Beat', description: 'Software revenue up {percent}% - Cloud services driving growth' }
                ],
                VRZO: [
                    { type: 'product', icon: '🚗', title: 'EV Technology', description: 'New {tech} technology partnership with {company} announced' },
                    { type: 'factory', icon: '⚡', title: 'Battery Innovation', description: 'Revolutionary {type} battery technology increases range by {percent}%' },
                    { type: 'deal', icon: '🌍', title: 'Global Expansion', description: 'Expanding operations to {region} with ${investment}M investment' }
                ]
            };

            const companies = ['Tesla', 'Apple', 'Microsoft', 'Google', 'Amazon'];
            const countries = ['India', 'USA', 'Germany', 'Japan', 'UK'];
            const locations = ['Mumbai', 'Delhi', 'Bangalore', 'Chennai', 'Pune'];
            const technologies = ['AI-powered', 'blockchain-based', 'quantum', 'neural network'];
            const industries = ['automotive', 'healthcare', 'finance', 'manufacturing'];

            Object.keys(newsTemplates).forEach(stock => {
                if (Math.random() < 0.1) { // 10% chance per update
                    const templates = newsTemplates[stock];
                    const template = templates[Math.floor(Math.random() * templates.length)];
                    
                    let description = template.description
                        .replace('{result}', Math.random() > 0.5 ? 'strong' : 'mixed')
                        .replace('{quarter}', ['Q1', 'Q2', 'Q3', 'Q4'][Math.floor(Math.random() * 4)])
                        .replace('{revenue}', (200 + Math.random() * 300).toFixed(0))
                        .replace('{expected}', (180 + Math.random() * 250).toFixed(0))
                        .replace('{amount}', (20 + Math.random() * 80).toFixed(0))
                        .replace('{value}', (100 + Math.random() * 400).toFixed(0))
                        .replace('{percent}', (5 + Math.random() * 25).toFixed(0))
                        .replace('{location}', locations[Math.floor(Math.random() * locations.length)])
                        .replace('{country}', countries[Math.floor(Math.random() * countries.length)])
                        .replace('{company}', companies[Math.floor(Math.random() * companies.length)])
                        .replace('{tech}', technologies[Math.floor(Math.random() * technologies.length)])
                        .replace('{technology}', technologies[Math.floor(Math.random() * technologies.length)])
                        .replace('{industry}', industries[Math.floor(Math.random() * industries.length)])
                        .replace('{type}', ['lithium-ion', 'solid-state', 'graphene'][Math.floor(Math.random() * 3)])
                        .replace('{region}', ['Southeast Asia', 'Europe', 'Middle East'][Math.floor(Math.random() * 3)])
                        .replace('{investment}', (50 + Math.random() * 200).toFixed(0));

                    const newsEvent = {
                        id: Date.now() + Math.random(),
                        stock: stock,
                        type: template.type,
                        icon: template.icon,
                        title: template.title.replace('{quarter}', ['Q1', 'Q2', 'Q3', 'Q4'][Math.floor(Math.random() * 4)]),
                        description: description,
                        timestamp: Date.now(),
                        position: 20 + Math.random() * 60,
                        index: Math.floor(Math.random() * 25) + 5
                    };

                    globalNewsEvents.push(newsEvent);
                    
                    // Keep only last 10 news events
                    if (globalNewsEvents.length > 10) {
                        globalNewsEvents = globalNewsEvents.slice(-10);
                    }

                    console.log(`📰 New ${stock} news: ${newsEvent.title}`);
                }
            });
        }

        function getNewsEvents(stock, timeframe) {
            return globalNewsEvents.filter(event => 
                event.stock === stock && 
                Date.now() - event.timestamp < 24 * 60 * 60 * 1000 // Last 24 hours
            );
        }

        function showNewsTooltip(event, newsEvent) {
            const tooltip = document.getElementById('newsTooltip');
            tooltip.style.display = 'block';
            tooltip.style.left = event.pageX + 10 + 'px';
            tooltip.style.top = event.pageY - 10 + 'px';
            tooltip.innerHTML = `
                <h4>${newsEvent.title}</h4>
                <p>${newsEvent.description}</p>
            `;
        }

        function hideNewsTooltip() {
            document.getElementById('newsTooltip').style.display = 'none';
        }

        function renderVolume(data) {
            const volumeChart = document.getElementById('volumeBars');
            volumeChart.innerHTML = '';
            
            const maxVolume = Math.max(...data.map(d => d.volume));
            
            data.forEach(candle => {
                const bar = document.createElement('div');
                bar.className = 'volume-bar';
                bar.style.height = `${(candle.volume / maxVolume) * 60}px`;
                bar.style.background = candle.type === 'red' ? '#ff453a' : '#30d158';
                volumeChart.appendChild(bar);
            });
        }

        function showTooltip(event, candle, index) {
            const tooltip = document.getElementById('tooltip');
            const currentDate = new Date();
            currentDate.setDate(currentDate.getDate() - (30 - index));
            
            // Convert to Indian Standard Time
            const istDate = new Date(currentDate.toLocaleString("en-US", {timeZone: "Asia/Kolkata"}));
            
            const changePercent = index > 0 ? 
                ((candle.close - stockData[currentStock].timeframes[currentTimeframe][index-1].close) / 
                 stockData[currentStock].timeframes[currentTimeframe][index-1].close * 100).toFixed(2) : 0;
            
            tooltip.style.display = 'block';
            tooltip.style.left = event.pageX + 10 + 'px';
            tooltip.style.top = event.pageY - 10 + 'px';
            tooltip.innerHTML = `
                <div class="tooltip-header">${istDate.toLocaleDateString('en-IN', { 
                    month: 'short', 
                    day: 'numeric', 
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    timeZone: 'Asia/Kolkata'
                })} IST</div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Open:</span>
                    <span class="tooltip-value">₹${(candle.open * 83.12).toFixed(2)} | $${candle.open.toFixed(2)}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">High:</span>
                    <span class="tooltip-value">₹${(candle.high * 83.12).toFixed(2)} | $${candle.high.toFixed(2)}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Low:</span>
                    <span class="tooltip-value">₹${(candle.low * 83.12).toFixed(2)} | $${candle.low.toFixed(2)}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Close:</span>
                    <span class="tooltip-value">₹${(candle.close * 83.12).toFixed(2)} | $${candle.close.toFixed(2)}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Volume:</span>
                    <span class="tooltip-value">${(candle.volume * 1000000).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",")}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Change:</span>
                    <span class="tooltip-value ${changePercent >= 0 ? 'price-up' : 'price-down'}">${changePercent >= 0 ? '+' : ''}${changePercent}%</span>
                </div>
            `;
        }

        function hideTooltip() {
            document.getElementById('tooltip').style.display = 'none';
        }

        function updateStockDisplay(stockSymbol, timeframe = currentTimeframe) {
            const stock = stockData[stockSymbol];
            
            document.getElementById('currentSymbol').textContent = stock.name;
            document.getElementById('currentPrice').textContent = `$${stock.currentPrice.toFixed(2)}`;
            
            const changeElement = document.getElementById('priceChange');
            const changeClass = stock.change >= 0 ? 'price-up' : 'price-down';
            const changeSign = stock.change >= 0 ? '+' : '';
            changeElement.textContent = `${changeSign}$${stock.change.toFixed(2)} (${changeSign}${stock.changePercent.toFixed(2)}%) Today`;
            changeElement.className = `price-change ${changeClass}`;
            
            document.getElementById('currentPrice').className = `stock-price ${changeClass}`;
            
            // Update sidebar
            document.getElementById('marketCap').textContent = stock.marketCap;
            document.getElementById('peRatio').textContent = stock.peRatio;
            document.getElementById('volume').textContent = stock.volume;
            document.getElementById('avgVolume').textContent = stock.avgVolume;
            document.getElementById('weekHigh').textContent = stock.weekHigh;
            document.getElementById('weekLow').textContent = stock.weekLow;
            document.getElementById('earningsDate').textContent = stock.earningsDate;
            document.getElementById('exDividend').textContent = stock.exDividend;
            document.getElementById('priceTarget').textContent = stock.priceTarget;
            document.getElementById('rating').textContent = stock.rating;
            
            // Update dynamic analyst ratings
            document.getElementById('buyRating').textContent = `${stock.analystRatings.buy}% Buy`;
            document.getElementById('holdRating').textContent = `${stock.analystRatings.hold}% Hold`;
            document.getElementById('sellRating').textContent = `${stock.analystRatings.sell}% Sell`;
            
            // Update support/resistance levels
            document.getElementById('supportLevel').textContent = `$${stock.supportLevel.toFixed(2)}`;
            document.getElementById('resistanceLevel').textContent = `$${stock.resistanceLevel.toFixed(2)}`;
            
            // Render charts with current timeframe data
            const chartData = stock.timeframes[timeframe];
            renderCandlesticks(chartData);
            renderVolume(chartData);
        }

        function toggleTheme() {
            // Theme toggle functionality placeholder
            const themeBtn = document.querySelector('.theme-toggle');
            if (themeBtn.textContent.includes('Dark')) {
                themeBtn.innerHTML = '☀️ Light';
            } else {
                themeBtn.innerHTML = '🌙 Dark';
            }
        }

        // Technical Indicators Toggle Functions
        function toggleIndicator(indicatorName) {
            indicatorStates[indicatorName] = !indicatorStates[indicatorName];
            
            switch(indicatorName) {
                case 'rsi':
                    document.getElementById('rsiChart').classList.toggle('active', indicatorStates.rsi);
                    break;
                case 'macd':
                    document.getElementById('macdChart').classList.toggle('active', indicatorStates.macd);
                    break;
                case 'bollinger':
                    document.getElementById('bollingerBands').classList.toggle('active', indicatorStates.bollinger);
                    break;
                case 'vwap':
                    document.getElementById('vwapLine').classList.toggle('active', indicatorStates.vwap);
                    break;
                case 'fibonacci':
                    document.getElementById('fibonacciLevels').classList.toggle('active', indicatorStates.fibonacci);
                    break;
            }
        }

        // Event listeners
        document.querySelectorAll('.stock-tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                document.querySelectorAll('.stock-tab').forEach(t => t.classList.remove('active'));
                e.target.classList.add('active');
                currentStock = e.target.dataset.stock;
                updateStockDisplay(currentStock);
            });
        });

        document.querySelectorAll('.timeframe-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.timeframe-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                currentTimeframe = e.target.textContent;
                updateStockDisplay(currentStock, currentTimeframe);
            });
        });

        document.querySelectorAll('.toggle-switch').forEach(toggle => {
            toggle.addEventListener('click', (e) => {
                e.target.classList.toggle('active');
                const indicator = e.target.dataset.indicator;
                toggleIndicator(indicator);
            });
        });

        // Add click event to branding for 5-click admin access
        document.getElementById('brandingText').addEventListener('click', handleBrandingClick);

        // Initialize all systems
        loadPersistentData();
        updateStockDisplay(currentStock);
        updateMarketIndices();
        
        // Start news generation (every 2 minutes)
        setInterval(generateRandomNews, 120000);
        
        // Generate initial news
        generateRandomNews();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'969d5b0a66013a33',t:'MTc1NDMwMzE3Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
